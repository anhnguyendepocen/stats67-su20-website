---
title: "Confidence Interval for Difference of Two Proportions"
author: "Dr. Dogucu"
output: 
  xaringan::moon_reader:
    css: slide-style.css
    nature:
      ratio: 16:9
      highlightStyle: github
      highlightLines: true
      
---

layout: true
  
<div class="my-header"></div>

<div class="my-footer"> 
 Copyright &copy; <a href="https://mdogucu.ics.uci.edu">Dr. Mine Dogucu</a>. <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div> 


---


class: middle

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.align = "center")
library(tidyverse)
options(scipen=0)
theme_set(theme_gray(base_size = 18))

set.seed(84735)


```




## Example

Do those who take college level science courses and those who don't have different rates of belief in life after death? Below are the responses from General Social Survey in 2018.



<table align = "center">
<thead>
  <tr>
    <th colspan="2" rowspan="2"></th>
    <th colspan="2">Belief in Life After Death</th>
  </tr>
  <tr>
    <td>Yes</td>
    <td>No<br></td>
  </tr>
</thead>
<tbody>
  <tr>
    <td rowspan="2">College Science Course<br></td>
    <td>Yes</td>
    <td>375</td>
    <td>75</td>
  </tr>
  <tr>
    <td>No</td>
    <td>485</td>
    <td>115</td>
  </tr>
</tbody>
</table>

---

class: middle

## Understanding the Question

Response: Belief in Life After Death (categorical)   
Explanatory: College Science Course 

---

class: middle

## What did we observe?

Belief in Life After Death Among College Science Course Takers

$p_{science} = \frac{375}{375+75} = 0.8333333$  

$n_{science} = 450$

Belief in Life After Death Among Non - College Science Course Takers

$p_{noscience} = \frac{485}{485+115} = 0.8083333$  

$n_{noscience} = 600$

---

class: middle

## What did we observe?


It seems like there are more after life believers among college science course takers (~83%) when compared to those who did not take college science course (~80.83%). But now that we have taken statistics course we cannot only rely on comparison of sample statistics. We know we have to think about population parameters.

---

class: middle

## CLT for two proportions

If conditions are met then according to CLT $(p_1 - p_2) \sim \text{approximately } N(\pi_1 - \pi_2,  {\frac{\pi_1(1-\pi_1)}{n_1} + \frac{\pi_2(1-\pi_2)}{n_2}})$

--

Recall that the standard deviation of the the sampling distribution is the standard error.

--

Standard error for difference of two proportions

$\sqrt{\frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}}$

---

class: middle

## Conditions

`r fontawesome::fa(name = "check", fill = "#e56646")` Independence: Within each group data have to be independent from each other. The two groups have to be independent from one another.

GSS utilizes some form of random sampling so we would expect independence within each group. People either have taken a college level science class or they have not taken so we can assume that the groups are independent from one another.

--

`r fontawesome::fa(name = "check", fill = "#e56646")` There needs to be at least 10 successes and 10 failures in each group.

We have seen that all the values in the contingency table were greater than 10.

--

`r fontawesome::fa(name = "check", fill = "#e56646")` For each group the sample size needs to be smaller than 10% of the population. 

Sample size of 1050 is less than 10% of the US population.

---


## Confidence Interval Construction 

CI = $\text{point estimate} \pm \text { critical value} \times \text{standard error}$

CI for difference of two proportions = $p_1 - p_2 \pm \text { critical value} \times\sqrt{{\frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}}}$

### Steps

1. Calculate point estimate.  
2. Calculate critical value.
3. Calculate standard error.
4. Construct the confidence interval.


---

CI for difference of two proportions = $p_1 - p_2 \pm \text { critical value} \times \sqrt{{\frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}}}$

.pull-left[

```{r echo = TRUE}
p1 <- 0.83
p2 <- 0.8083
n1 <- 450
n2 <- 600

point_estimate <- p1 - p2

cv <- qnorm(0.975)
cv

```

]

--

.pull-right[
```{r echo = TRUE}
se <- sqrt((p1*(1-p1)/n1)+(p2*(1-p2)/n2))

point_estimate - cv*se

point_estimate + cv*se
```

95%CI for $p_1-p_2$ is (-0.025,0.069)
]
